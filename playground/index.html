<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>utf8proj Playground - Project Scheduling in the Browser</title>
    <link rel="stylesheet" href="styles/main.css">
    <!-- Monaco Editor -->
    <link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/editor/editor.main.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1>utf8proj <span class="badge">Playground</span></h1>
            </div>
            <div class="header-center">
                <select id="format-select" title="Input format">
                    <option value="native">Native DSL</option>
                    <option value="tjp">TaskJuggler</option>
                </select>
                <button id="run-btn" class="btn btn-primary" title="Schedule (Ctrl+Enter)">
                    <span class="icon">â–¶</span> Run
                </button>
                <label class="checkbox-label" title="Enable resource leveling (RFC-0003)">
                    <input type="checkbox" id="leveling-checkbox">
                    Leveling
                </label>
                <label class="checkbox-label" title="Use optimal CP solver for small clusters (RFC-0014)">
                    <input type="checkbox" id="optimal-checkbox">
                    Optimal
                </label>
                <label class="checkbox-label" title="Show now line on Gantt chart (RFC-0017)">
                    <input type="checkbox" id="nowline-checkbox" checked>
                    Now Line
                </label>
                <label class="checkbox-label" title="Highlight critical path tasks in red">
                    <input type="checkbox" id="critical-checkbox" checked>
                    Critical Path
                </label>
                <div class="focus-controls" title="Focus view (RFC-0006)">
                    <input type="text" id="focus-input" placeholder="Focus: task ID or name" style="width: 140px;">
                    <select id="context-depth-select" title="Context depth">
                        <option value="0">Hide non-focus</option>
                        <option value="1" selected>1 level context</option>
                        <option value="2">2 levels context</option>
                    </select>
                </div>
            </div>
            <div class="header-right">
                <select id="example-select" title="Load example">
                    <option value="">Load Example...</option>
                    <option value="native">CRM Migration (Native)</option>
                    <option value="tjp">Software Release (TJP)</option>
                    <option value="hierarchical">Hierarchical Tasks</option>
                    <option value="progress">Progress Tracking (RFC-0008)</option>
                    <option value="focus">Focus View (RFC-0006)</option>
                    <option value="temporal">Temporal Regimes (RFC-0012)</option>
                    <option value="leveling">Resource Leveling (RFC-0003/0014)</option>
                </select>
                <button id="share-btn" class="btn" title="Share project">Share</button>
                <button id="theme-btn" class="btn" title="Toggle dark mode">ðŸŒ™</button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main">
            <!-- Editor Panel -->
            <div class="panel editor-panel">
                <div class="panel-header">
                    <span>Editor</span>
                    <div class="panel-actions">
                        <button id="download-proj-btn" class="btn-small" title="Download project file">Download</button>
                    </div>
                </div>
                <div id="editor" class="editor-container"></div>
            </div>

            <!-- Resize Handle -->
            <div class="resize-handle" id="resize-handle"></div>

            <!-- Preview Panel -->
            <div class="panel preview-panel">
                <div class="panel-header">
                    <span>Preview</span>
                    <div class="panel-tabs">
                        <button class="tab active" data-tab="gantt">Gantt</button>
                        <button class="tab" data-tab="json">JSON</button>
                    </div>
                    <div class="panel-actions">
                        <select id="export-format-select" class="btn-small" title="Export format">
                            <option value="html">HTML</option>
                            <option value="xlsx">Excel (XLSX)</option>
                            <option value="mermaid">Mermaid</option>
                            <option value="plantuml">PlantUML</option>
                        </select>
                        <button id="excel-options-btn" class="btn-small hidden" title="Excel Options">âš™</button>
                        <button id="export-btn" class="btn-small" title="Export Gantt chart">Export</button>
                    </div>
                </div>
                <!-- Excel Options Panel (RFC-0018 Phase 4) -->
                <div id="excel-options-panel" class="excel-options hidden">
                    <div class="option-group">
                        <label class="option-group-title">Timescale</label>
                        <div class="option-row">
                            <label><input type="radio" name="excel-scale" value="weekly" checked> Weekly</label>
                            <label><input type="radio" name="excel-scale" value="daily"> Daily</label>
                        </div>
                        <div class="option-row">
                            <label>
                                <input type="checkbox" id="excel-autofit" checked>
                                Auto-fit to project duration
                            </label>
                        </div>
                        <div class="option-row hidden" id="excel-manual-weeks">
                            <label>Weeks: <input type="number" id="excel-weeks" value="20" min="1" max="104"></label>
                        </div>
                    </div>
                    <div class="option-group">
                        <label class="option-group-title">Formatting</label>
                        <div class="option-row">
                            <label>Currency:
                                <select id="excel-currency">
                                    <option value="EUR">EUR (â‚¬)</option>
                                    <option value="USD">USD ($)</option>
                                    <option value="GBP">GBP (Â£)</option>
                                    <option value="CHF">CHF</option>
                                    <option value="JPY">JPY (Â¥)</option>
                                </select>
                            </label>
                            <label>Hours/Day: <input type="number" id="excel-hours" value="8" min="1" max="24" step="0.5"></label>
                        </div>
                    </div>
                    <div class="option-group">
                        <label class="option-group-title">Content</label>
                        <div class="option-row">
                            <label><input type="checkbox" id="excel-summary" checked> Include Summary Sheet</label>
                            <label><input type="checkbox" id="excel-deps" checked> Show Dependencies</label>
                        </div>
                    </div>
                    <div class="option-group">
                        <label class="option-group-title">Progress Tracking (RFC-0018)</label>
                        <div class="option-row">
                            <label>Progress Mode:
                                <select id="excel-progress">
                                    <option value="none">None</option>
                                    <option value="columns">Columns</option>
                                    <option value="visual">Visual</option>
                                    <option value="full">Full</option>
                                </select>
                            </label>
                        </div>
                        <div class="option-hint" id="excel-progress-hint">
                            No progress information (clean schedule view)
                        </div>
                    </div>
                </div>
                <div id="preview-gantt" class="preview-container active">
                    <div id="gantt-output" class="gantt-wrapper">
                        <div class="placeholder">
                            <p>Click <strong>Run</strong> to schedule your project</p>
                            <p class="hint">or press <kbd>Ctrl</kbd>+<kbd>Enter</kbd></p>
                        </div>
                    </div>
                </div>
                <div id="preview-json" class="preview-container">
                    <pre id="json-output" class="json-output"></pre>
                </div>
            </div>
        </main>

        <!-- Status Bar -->
        <footer class="status-bar">
            <div class="status-left">
                <span id="status-message">Ready</span>
            </div>
            <div class="status-center">
                <span id="schedule-info"></span>
            </div>
            <div class="status-right">
                <span class="version">v0.17.0</span>
                <span class="separator">|</span>
                <a href="syntax.html" target="_blank" title="Syntax Reference">Syntax</a>
                <span class="separator">|</span>
                <a href="https://github.com/alanbld/utf8proj" target="_blank" title="GitHub Repository">GitHub</a>
            </div>
        </footer>

        <!-- Share Modal -->
        <div id="share-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Share Project</h2>
                    <button class="modal-close" id="share-modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Copy this URL to share your project:</p>
                    <div class="share-url-container">
                        <input type="text" id="share-url" readonly>
                        <button id="copy-url-btn" class="btn">Copy</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Monaco Editor Loader -->
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>

    <!-- LZ-String for URL compression -->
    <script src="https://cdn.jsdelivr.net/npm/lz-string@1.5.0/libs/lz-string.min.js"></script>

    <!-- WASM Module -->
    <script type="module" src="src/main.js"></script>
</body>
</html>
